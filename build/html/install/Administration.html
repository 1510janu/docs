<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Administration &mdash; Mattermost 1.3 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Mattermost 1.3 documentation" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="administration">
<span id="administration"></span><h1>Administration<a class="headerlink" href="#administration" title="Permalink to this headline">¶</a></h1>
<p>This document provides instructions for common administrator tasks</p>
<div class="section" id="important-notes">
<span id="important-notes"></span><h2>Important notes<a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="do-not-manipulate-the-mattermost-database">
<span id="do-not-manipulate-the-mattermost-database"></span><h3><strong>DO NOT manipulate the Mattermost database</strong><a class="headerlink" href="#do-not-manipulate-the-mattermost-database" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In particular, DO NOT delete data from the database, as Mattermost is designed to stop working if data integrity has been compromised. The system is designed to archive content continously and generally assumes data is never deleted.</li>
</ul>
</div>
</div>
<div class="section" id="common-tasks">
<span id="common-tasks"></span><h2>Common Tasks<a class="headerlink" href="#common-tasks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-system-administrator-account-from-commandline">
<span id="creating-system-administrator-account-from-commandline"></span><h3>Creating System Administrator account from commandline<a class="headerlink" href="#creating-system-administrator-account-from-commandline" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If the System Administrator account becomes unavailable, a person leaving the organization for example, you can set a new system admin from the commandline using <code class="docutils literal"><span class="pre">./platform</span> <span class="pre">-assign_role</span> <span class="pre">-team_name=&quot;yourteam&quot;</span> <span class="pre">-email=&quot;you&#64;example.com&quot;</span> <span class="pre">-role=&quot;system_admin&quot;</span></code>.</li>
<li>After assigning the role the user needs to log out and log back in before the System Administrator role is applied.</li>
</ul>
</div>
<div class="section" id="deactivating-a-user">
<span id="deactivating-a-user"></span><h3>Deactivating a user<a class="headerlink" href="#deactivating-a-user" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Team Admin or System Admin can go to <strong>Main Menu</strong> &gt; <strong>Manage Members</strong> &gt; <strong>Make Inactive</strong> to deactivate a user, which removes them from the team.</li>
<li>To preserve audit history, users are never deleted from the system. It is highly recommended that System Administrators do not attempt to delete users manually from the database, as this may compromise system integrity and ability to upgrade in future.</li>
</ul>
</div>
</div>
<div class="section" id="gitlab-mattermost-administration">
<span id="gitlab-mattermost-administration"></span><h2>GitLab Mattermost Administration<a class="headerlink" href="#gitlab-mattermost-administration" title="Permalink to this headline">¶</a></h2>
<p>GitLab Mattermost is a special version of Mattermost bundled with GitLab omnibus. Here we consolidate administrative instructions, guides and troubleshooting guidance.</p>
<div class="section" id="installing-gitlab-mattermost">
<span id="installing-gitlab-mattermost"></span><h3>Installing GitLab Mattermost<a class="headerlink" href="#installing-gitlab-mattermost" title="Permalink to this headline">¶</a></h3>
<p>Please follow the <a class="reference external" href="http://doc.gitlab.com/omnibus/gitlab-mattermost/">GitLab Omnibus documentation for installing GitLab Mattermost</a>.</p>
</div>
<div class="section" id="community-support-resources">
<span id="community-support-resources"></span><h3>Community Support Resources<a class="headerlink" href="#community-support-resources" title="Permalink to this headline">¶</a></h3>
<p>For help and support around your GitLab Mattermost deployment please see:</p>
<ul class="simple">
<li><a class="reference external" href="https://forum.mattermost.org/c/general/gitlab">GitLab Mattermost discussion forum</a></li>
<li><a class="reference external" href="https://gitlab.com/gitlab-org/gitlab-mattermost/issues">GitLab Mattermost issue tracker on GitLab.com</a></li>
</ul>
</div>
<div class="section" id="connecting-mattermost-to-integrations-with-incoming-webhooks">
<span id="connecting-mattermost-to-integrations-with-incoming-webhooks"></span><h3>Connecting Mattermost to integrations with incoming webhooks<a class="headerlink" href="#connecting-mattermost-to-integrations-with-incoming-webhooks" title="Permalink to this headline">¶</a></h3>
<div class="section" id="connecting-mattermost-to-gitlab-for-slack-equivalent-functionality">
<span id="connecting-mattermost-to-gitlab-for-slack-equivalent-functionality"></span><h4>Connecting Mattermost to GitLab for Slack-equivalent functionality.<a class="headerlink" href="#connecting-mattermost-to-gitlab-for-slack-equivalent-functionality" title="Permalink to this headline">¶</a></h4>
<p>Mattermost is designed to be <em>Slack-compatible, not Slack-limited</em> and supports integration via the Slack UI in GitLab, as well as fully customizable integrations.</p>
<p>To enable this:</p>
<ol class="simple">
<li>In Mattermost, from a team site where you have System Administration privileges, from the main menu go to <strong>System Console</strong> &gt; <strong>Serice Settings</strong> &gt; <strong>Enable Incoming Webhooks</strong> and select <strong>true</strong> then click <strong>Save</strong></li>
<li>Follow the step-by-step example of <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/integrations/webhooks/Incoming-Webhooks.md#connecting-mattermost-to-gitlab-using-slack-ui">connecting Mattermost incoming webhooks to GitLab&#8217;s Slack webhooks UI</a>.</li>
</ol>
</div>
<div class="section" id="connecting-mattermost-to-gitlab-for-functionality-exceeding-slack-integration">
<span id="connecting-mattermost-to-gitlab-for-functionality-exceeding-slack-integration"></span><h4>Connecting Mattermost to GitLab for functionality exceeding Slack integration.<a class="headerlink" href="#connecting-mattermost-to-gitlab-for-functionality-exceeding-slack-integration" title="Permalink to this headline">¶</a></h4>
<p>To enable this:</p>
<ol class="simple">
<li>In Mattermost, from a team site where you have System Administration privileges, from the main menu go to <strong>System Console</strong> &gt; <strong>Serice Settings</strong> &gt; <strong>Enable Incoming Webhooks</strong> and select <strong>true</strong> then click <strong>Save</strong></li>
<li>Set up the <a class="reference external" href="https://github.com/mattermost/mattermost-integration-gitlab">GitLab Integration Service for Mattermost</a>.</li>
</ol>
</div>
</div>
<div class="section" id="connecting-mattermost-to-integrations-with-outgoing-webhooks">
<span id="connecting-mattermost-to-integrations-with-outgoing-webhooks"></span><h3>Connecting Mattermost to integrations with outgoing webhooks<a class="headerlink" href="#connecting-mattermost-to-integrations-with-outgoing-webhooks" title="Permalink to this headline">¶</a></h3>
<p>Mattermost offers Slack-compatible outgoing webhooks, that can connect to applications created by the Mattermost community, such as <a class="reference external" href="https://www.npmjs.com/package/hubot-mattermost">Hubot</a> and <a class="reference external" href="https://github.com/42wim/matterbridge">IRC</a> support.</p>
<p>To enable this:</p>
<ol class="simple">
<li>In Mattermost, from a team site where you have System Administration privileges, from the main menu go to <strong>System Console</strong> &gt; <strong>Serice Settings</strong> &gt; <strong>Enable Outgoing Webhooks</strong> and select <strong>true</strong> then click <strong>Save</strong></li>
<li>Select a <a class="reference external" href="http://www.mattermost.org/community-applications/">Mattermost community application</a> using outgoing webhooks&#8211;or adapt a Slack application using the same outgoing webhook standard&#8211;and follow the setup instructions provided.</li>
</ol>
</div>
<div class="section" id="upgrading-gitlab-mattermost-manually">
<span id="upgrading-gitlab-mattermost-manually"></span><h3>Upgrading GitLab Mattermost manually<a class="headerlink" href="#upgrading-gitlab-mattermost-manually" title="Permalink to this headline">¶</a></h3>
<p>If you choose to upgrade Mattermost outside of GitLab&#8217;s omnibus automation, please <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/install/Upgrade-Guide.md#upgrading-mattermost-to-next-major-release">follow this guide</a>.</p>
</div>
<div class="section" id="upgrading-gitlab-mattermost-from-gitlab-8-0-containing-mattermost-0-7-1-beta">
<span id="upgrading-gitlab-mattermost-from-gitlab-8-0-containing-mattermost-0-7-1-beta"></span><h3>Upgrading GitLab Mattermost from GitLab 8.0 (containing Mattermost 0.7.1-beta)<a class="headerlink" href="#upgrading-gitlab-mattermost-from-gitlab-8-0-containing-mattermost-0-7-1-beta" title="Permalink to this headline">¶</a></h3>
<p>To upgrade GitLab Mattermost from the 0.7.1-beta release of Mattermost in GitLab 8.0, please <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/install/Upgrade-Guide.md#upgrading-mattermost-in-gitlab-80-to-gitlab-81-with-omnibus">follow this guide</a>.</p>
</div>
<div class="section" id="troubleshooting-gitlab-mattermost">
<span id="troubleshooting-gitlab-mattermost"></span><h3>Troubleshooting GitLab Mattermost<a class="headerlink" href="#troubleshooting-gitlab-mattermost" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If you&#8217;re having issues installing GitLab Mattermost with GitLab Omnibus, as a first step please turn on logging by updating the <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/install/Configuration-Settings.md#log-file-settings">log settings</a> section in your <code class="docutils literal"><span class="pre">config.json</span></code> file installed by omnibus, and they try a general web search for the error message you receive.</li>
</ul>
<div class="section" id="gitlab-mattermost-error-messages">
<span id="gitlab-mattermost-error-messages"></span><h4>GitLab Mattermost Error Messages<a class="headerlink" href="#gitlab-mattermost-error-messages" title="Permalink to this headline">¶</a></h4>
<div class="section" id="we-received-an-unexpected-status-code-from-the-server-200">
<span id="we-received-an-unexpected-status-code-from-the-server-200"></span><h5><code class="docutils literal"><span class="pre">We</span> <span class="pre">received</span> <span class="pre">an</span> <span class="pre">unexpected</span> <span class="pre">status</span> <span class="pre">code</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">server</span> <span class="pre">(200)</span></code><a class="headerlink" href="#we-received-an-unexpected-status-code-from-the-server-200" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>If you have upgraded from a pre-released version of GitLab Mattermost or if an unforseen issue has arrisen during the <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/install/Upgrade-Guide.md">upgrade procedure</a>, you may be able to restore Mattermost using the following procedure:<ul>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">stop</span> <span class="pre">mattermost</span></code>, so DB can be dropped</li>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">gitlab-ctl</span> <span class="pre">reconfigure</span></code></li>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">gitlab-psql</span> <span class="pre">/opt/gitlab/embedded/bin/dropdb</span> <span class="pre">-h</span> <span class="pre">/var/opt/gitlab/postgresql</span> <span class="pre">mattermost_production</span></code></li>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">start</span> <span class="pre">mattermost</span></code></li>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">gitlab-ctl</span> <span class="pre">reconfigure</span></code></li>
<li><a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/integrations/Single-Sign-On/Gitlab.md">Manually set up GitLab SSO</a> by copying Secret and ID into <code class="docutils literal"><span class="pre">/var/opt/gitlab/mattermost/config.json</span></code></li>
<li><code class="docutils literal"><span class="pre">sudo</span> <span class="pre">gitlab-ctl</span> <span class="pre">restart</span></code></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="token-request-failed">
<span id="token-request-failed"></span><h5><code class="docutils literal"><span class="pre">Token</span> <span class="pre">request</span> <span class="pre">failed</span></code><a class="headerlink" href="#token-request-failed" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>This error can appear in the web browser after attempting to create a new team with GitLab SSO enabled</li>
<li><strong>Solutions:</strong><ol>
<li>Check that your SSL settings for the SSO provider match the <code class="docutils literal"><span class="pre">http://</span></code> or <code class="docutils literal"><span class="pre">https://</span></code> choice selected in <code class="docutils literal"><span class="pre">config.json</span></code> under <code class="docutils literal"><span class="pre">GitLabSettings</span></code></li>
<li>Follow steps 1 to 3 of the manual <a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/integrations/Single-Sign-On/Gitlab.md">GitLab SSO configuration procedure</a> to confirm your <code class="docutils literal"><span class="pre">Secret</span></code> and <code class="docutils literal"><span class="pre">Id</span></code> settings in <code class="docutils literal"><span class="pre">config.json</span></code> match your GitLab settings, and if they don&#8217;t, manually update <code class="docutils literal"><span class="pre">config.json</span></code> to the correct settings and see if this clears the issue.</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="we-couldn-t-find-the-existing-account">
<span id="we-couldn-t-find-the-existing-account"></span><h5><code class="docutils literal"><span class="pre">We</span> <span class="pre">couldn't</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">existing</span> <span class="pre">account</span></code><a class="headerlink" href="#we-couldn-t-find-the-existing-account" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>This error appears when a user attempts to sign in using a single-sign-on option with an account that was not created using that single-sign-on option. For example, if a user creates Account A using email sign-up, then attempts to sign-in using GitLab SSO, the error appears since Account A was not created using GitLab SSO.</li>
<li><strong>Solution:</strong><ul>
<li>If you&#8217;re switching from email auth to GitLab SSO, and you&#8217;re getting this issue on an admin account, consider deactivating your email-based account, then creating a new account with System Admin privileges using GitLab SSO. Specifically:<ol>
<li>Deactivate your email-based System Admin account (note: this process is <a class="reference external" href="https://mattermost.atlassian.net/browse/PLT-975">scheduled to improve</a>)</li>
<li>Temporarily turn off email verification (<strong>System Console</strong> &gt; <strong>Email Settings</strong> &gt; <strong>Require Email Verification</strong> &gt; <strong>false</strong>, or set <code class="docutils literal"><span class="pre">&quot;RequireEmailVerification&quot;:</span> <span class="pre">false</span></code> in <code class="docutils literal"><span class="pre">config.json</span></code>).</li>
<li>Change email for account to random address so you can create a new GitLab SSO account using your regular address.</li>
<li>Create a new Mattermost account using GitLab SSO</li>
<li>With GitLab SSO enabled, go to <code class="docutils literal"><span class="pre">https://domain.com/teamname</span></code> and sign-up for a new Mattermost account using your GitLab SSO account with preferred email address.</li>
<li><a class="reference external" href="https://github.com/mattermost/platform/blob/master/doc/install/Troubleshooting.md#lost-system-administrator-account">Upgrade the new account to System Admin privileges</a>.</li>
<li>Deactivate the previous System Admin account that used email authentication.</li>
<li>Using the new GitLab SSO System Admin account go to <strong>System Console</strong> &gt; <strong>[TEAMNAME]</strong> &gt; <strong>Users</strong>, find the previous account and set it to &#8220;Inactive&#8221;</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Administration</a><ul>
<li><a class="reference internal" href="#important-notes">Important notes</a><ul>
<li><a class="reference internal" href="#do-not-manipulate-the-mattermost-database"><strong>DO NOT manipulate the Mattermost database</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-tasks">Common Tasks</a><ul>
<li><a class="reference internal" href="#creating-system-administrator-account-from-commandline">Creating System Administrator account from commandline</a></li>
<li><a class="reference internal" href="#deactivating-a-user">Deactivating a user</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gitlab-mattermost-administration">GitLab Mattermost Administration</a><ul>
<li><a class="reference internal" href="#installing-gitlab-mattermost">Installing GitLab Mattermost</a></li>
<li><a class="reference internal" href="#community-support-resources">Community Support Resources</a></li>
<li><a class="reference internal" href="#connecting-mattermost-to-integrations-with-incoming-webhooks">Connecting Mattermost to integrations with incoming webhooks</a><ul>
<li><a class="reference internal" href="#connecting-mattermost-to-gitlab-for-slack-equivalent-functionality">Connecting Mattermost to GitLab for Slack-equivalent functionality.</a></li>
<li><a class="reference internal" href="#connecting-mattermost-to-gitlab-for-functionality-exceeding-slack-integration">Connecting Mattermost to GitLab for functionality exceeding Slack integration.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#connecting-mattermost-to-integrations-with-outgoing-webhooks">Connecting Mattermost to integrations with outgoing webhooks</a></li>
<li><a class="reference internal" href="#upgrading-gitlab-mattermost-manually">Upgrading GitLab Mattermost manually</a></li>
<li><a class="reference internal" href="#upgrading-gitlab-mattermost-from-gitlab-8-0-containing-mattermost-0-7-1-beta">Upgrading GitLab Mattermost from GitLab 8.0 (containing Mattermost 0.7.1-beta)</a></li>
<li><a class="reference internal" href="#troubleshooting-gitlab-mattermost">Troubleshooting GitLab Mattermost</a><ul>
<li><a class="reference internal" href="#gitlab-mattermost-error-messages">GitLab Mattermost Error Messages</a><ul>
<li><a class="reference internal" href="#we-received-an-unexpected-status-code-from-the-server-200"><code class="docutils literal"><span class="pre">We</span> <span class="pre">received</span> <span class="pre">an</span> <span class="pre">unexpected</span> <span class="pre">status</span> <span class="pre">code</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">server</span> <span class="pre">(200)</span></code></a></li>
<li><a class="reference internal" href="#token-request-failed"><code class="docutils literal"><span class="pre">Token</span> <span class="pre">request</span> <span class="pre">failed</span></code></a></li>
<li><a class="reference internal" href="#we-couldn-t-find-the-existing-account"><code class="docutils literal"><span class="pre">We</span> <span class="pre">couldn't</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">existing</span> <span class="pre">account</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/install/Administration.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Mattermost.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="../_sources/install/Administration.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>